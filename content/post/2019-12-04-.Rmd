---
title: 区块链双花攻击
author: Xiaohui Li
date: '2019-12-04'
slug: ''
categories:
  - blcokchain
tags:
  - bitcoin
---

\quad \quad 区块链中的双花攻击的建模，可以用酒鬼漫步的概率模型来描述：
![](/post/2019-12-04-_files/酒鬼漫步.png)


\quad \quad 记酒鬼向右一步的概率为$p$,向左的概率为$1- p = q$则当他处在$x = n$的位置的时候，最后掉入悬崖$x = 0$的概率为$p(n)$,其概率为：
$$p(n) = (\frac{q}{p})^{n}$$
具体证明为：考虑$p(1)$,即酒鬼走完第一步后，要么向左位于$x = 0$处(此事件的发生概率为$q$)，要么向右位于$x = 2$处（此事件的发生概率为$p$）,然后掉入悬崖，概率为：
$$p(1) =  (1- p) + p \times  p(2)$$

进一步分析，从$x = 2$最终到达$x = 1$（可以是任意多个步骤）,然后最终$x = 0$（可以是任意多个步骤）,事实上均是概率$p(1)$,因此：
$$p(2) = p(1)^{2}$$
联立上述两个方程，得到$p(1)$有意义的解为：$$p(1) = \frac{1-p}{p} = \frac{q}{p}$$
因此可得到：
$$p\left(n \right) = p(1)^{n} = (\frac{q}{p})^{n}$$
其实上述问题和区块链双花共计的情况是一样的，记录: \\ 
$p$ ：为诚实链挖出块挖出的概率； \\
$q$：为非诚实链挖出块的概率； \\
$p(n)$：即非诚实链落后$n$个块后，追上诚实链的概率（可以想象为诚实链挖出块表示向右移动一格，否则向左移动一格，追赶上表示到达$x = 0$状态），因此概率表达为： \\ 
$$ p(n)=\left\{
\begin{aligned}
 & 1\quad q > p \\
 & (\frac qp)^{n} \quad q\le p\\
\end{aligned}
\right.
$$
